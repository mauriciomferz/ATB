server {
  bind_address = "0.0.0.0"
  bind_port = "8081"
  
  # Local socket for CLI access
  socket_path = "/tmp/spire-server/private/api.sock"

  trust_domain = "atb.example.org"

  data_dir = "/opt/spire/data"
  log_level = "INFO"

  # Short-lived SVIDs for security
  default_x509_svid_ttl = "10m"
  default_jwt_svid_ttl = "5m"
  
  # CA TTL
  ca_ttl = "24h"
}

plugins {
  DataStore "sql" {
    plugin_data {
      database_type = "sqlite3"
      connection_string = "/opt/spire/data/datastore.sqlite3"
    }
  }

  # For Docker demo, use join token attestation
  NodeAttestor "join_token" {
    plugin_data {}
  }

  KeyManager "disk" {
    plugin_data {
      keys_path = "/opt/spire/data/keys.json"
    }
  }

  # Self-signed CA for demo (use external CA in production)
  UpstreamAuthority "disk" {
    plugin_data {
      key_file_path = "/opt/spire/conf/server/dummy_upstream_ca.key"
      cert_file_path = "/opt/spire/conf/server/dummy_upstream_ca.crt"
    }
  }
}
